@model FossTechCrm.Entities.Lead

<div class="container-fluid page-body-wrapper">
    <div class="main-panel">
        <div class="content-wrapper">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Data table</h4>
                    <div class="row">
                        <div class="col-12">
                            <div class="text-center">
                                <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#exampleModal">Click for demo<i class="mdi mdi-play-circle ml-1"></i></button>
                            </div>
                            <div class="table-responsive">
                                <table id="order-listing" class="table">
                                    <thead>
                                        <tr>
                                            <th>Order #</th>
                                            <th>Company Name</th>
                                            <th>Contact Person</th>
                                            <th>Phone</th>

                                            <th>Status</th>
                                            <th>Actions</th>

                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr>
                                            <td>1</td>


                                            <td>FossTech</td>
                                            <td>Salman Khan</td>
                                            <td>7678078043</td>


                                            <td>
                                                <label class="badge badge-info">On hold</label>
                                            </td>
                                            <td>
                                                <button class="btn btn-outline-primary">View</button>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("postdata", "Home", FormMethod.Post, new { @id = "formsubmit" }))
                {
                    <div class="col-12 grid-margin">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title">Horizontal Two column</h4>
                                <form class="form-sample">
                                    <p class="card-description">
                                        Personal info
                                    </p>
                                    @Html.HiddenFor(m => m.ID, new { @id = "id" })
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Company Name</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.CompanyName, new { @class = "form-control", @name = "companyname", @id = "companyname", @placeholder = "Enter Comnpany Name" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">First Name</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.FirstName, new { @class = "form-control", @name = "firstname", @id = "companyname", @placeholder = "Enter First Name" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Email</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control", @name = "email", @id = "email", @placeholder = "Enter Email " })
                                                </div>
                                            </div>
                                        </div>
                                        @*<div class="col-md-6">
                <div class="form-group row">
                    <label class="col-sm-3 col-form-label">Status</label>
                    <div class="col-sm-4">
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="membershipRadios" id="membershipRadios1" value="" checked="">
                                Hot
                                <i class="input-helper"></i>
                            </label>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="membershipRadios" id="membershipRadios2" value="option2">
                                Cold
                                <i class="input-helper"></i>
                            </label>
                        </div>
                    </div>
                </div>
            </div>*@
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Email</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.Status, new { @class = "form-control", @name = "status", @id = "status", @placeholder = "Enter Status " })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="card-description">
                                        Description
                                    </p>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Address 1</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.Description, new { @class = "form-control", @name = "description", @id = "description", @placeholder = "Enter description Name" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">State</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.LeadSource, new { @class = "form-control", @name = "leadSource", @id = "leadSource", @placeholder = "Enter leadSource Name" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Address 2</label>
                                                <div class="col-sm-9">
                                                    @Html.TextBoxFor(m => m.Ratings, new { @class = "form-control", @name = "ratings", @id = "ratings", @placeholder = "Enter Ratings Name" })
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success btn-block" id="submitdata" onclick="btnsubmit()">Form submit</button>
                        <button type="button" class="btn btn-success btn-block" id="updaterecord" onclick="Updatesubmit()">Update Record</button>
                    </div>
                }
            </div>

        </div>
    </div>
</div>
@section scripts{
    <script>

            var Datatables;

               $(document).ready(function () {

                   Datatables = $("#order-listing").DataTable({

                       "ajax": {

                           "type": "GET",
                           "url": "@Url.Action("getdata","Home")",
                           "datatype": "JSON",

                       },
                       "columns": [


                           { "data": "id" },
                           { "data": "companyname" },
                           { "data": "firstname" },
                           { "data": "email" },
                           { "data": "status" },
                           { "data": "description" },
                           { "data": "leadSource" },
                           { "data": "ratings" },
                           {
                               "data": "id", "render": function (data) {


                                   return "<a class='btn btn-success' onclick=Editrow(" + data + ") style='margin-left:12px'><i class='glyphicon glyphicon-edit'></i> Edit Record<a/>  <a class='btn btn-danger' onclick=DeleteRow(" + data + ")><i class='glyphicon glyphicon-trash'></i> Delete<a/>";


                               },

                               "orderable": false,
                               "width": "250px"

                           },


                       ],
                       "language": {

                           "processing": "<img scr='d/loader.gif'/>",
                           "emptyTable": "No data found, you may click on <b>add new</b> button"
                       },




                   });

               });

    </script>


}

    <script>
        function addview() {

            $("#exampleModal").modal('show');
            $("#submitdata").show();
            $("#updaterecord").hide();

            $("#idGt").val("");
            $("#companyname").val("");
            $("#firstname").val("");
            $("#email").val("");
            $("#status").val("");
            $("#description").val("");
            $("#leadSource").val("");
            $("#ratings").val("");

            return false;
        }

        //$('#myModal').on('hidden.bs.modal', function () {
        //    datatables.ajax.reload();
        //});


        function btnsubmit() {
            var Data = $("#formsubmit").serialize();
            $.ajax({

                type: 'POST',
                url: '@Url.Action("postdata", "Home")',
                data: Data,
                datatype: 'JSON',
                success: function (response) {
                    if (response.result) {

                        $.notify(response.message, {

                            globalPosition: 'top right',
                            className: 'success',

                        })
                        Datatables.ajax.reload();
                        $("#exampleModal").modal('hide');
                    }
                },
                error: function (msg) {
                    alert(msg.responseText);
                }


            });
        }

        function DeleteRow(id) {
            if (confirm("Are You sure to delete this record..?")) {
                $.ajax({

                    type: 'POST',
                    url: '@Url.Action("delete", "Home")/' + id,
                    datatype:'JSON',
                    success: function (response) {
                        if (response == "success") {

                            alert("Data Deleted successfully..");
                            window.location.reload();
                            //$("#myModal").modal('hide');
                        }
                    },
                    error: function (msg) {
                        alert(msg.responseText);
                    }

                });
            }
        }

        function Editrow(id) {

            debugger

            $.ajax({

                type: 'GET',
                url:'@Url.Action("GetEdit", "Home")/'+ id,
                datatype: 'JSON',
                success: function (rs) {

                    $("#id").val(rs.id);
                    $("#name").val(rs.name);
                    $("#email").val(rs.email);
                    $("#address").val(rs.address);
                    $("#country").val(rs.country);
                    $("#pin").val(rs.pin);

                    $("#myModal").modal('show');
                    $("#submitdata").hide();
                    $("#updaterecord").show();

                },
                error: function (msg) {
                    alert(msg.responseText);
                }


            });
        }
        function Updatesubmit() {

            var Data = $("#formsubmit").serialize();
            $.ajax({

                type: 'POST',
                url: '@Url.Action("postdata", "Home")',
                data: Data,
                datatype: 'JSON',
                success: function (response) {
                    if (response.result) {

                        $.notify(response.message, {

                            globalPosition: 'top right',
                            className: 'success',

                        })

                        Datatables.ajax.reload();
                        $("#exampleModal").modal('hide');
                    }
                },
                error: function (msg) {
                    alert(msg.responseText);
                }


            });
        }



    </script>